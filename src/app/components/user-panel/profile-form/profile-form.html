<form 
  class="profile-form" 
  [formGroup]="profileForm" 
  (ngSubmit)="onSave()"
  novalidate
  [class.profile-form--loading]="isLoading">
  
  <!-- Mensaje de carga global -->
  <div class="profile-form__loading-overlay" *ngIf="isLoading">
    <div class="profile-form__loading-spinner">
      <i class="fas fa-spinner fa-spin" aria-hidden="true"></i>
      <span>Cargando...</span>
    </div>
  </div>

  <!-- Datos Básicos -->
  <fieldset class="profile-form__section">
    <legend class="profile-form__section-title">
      <i class="fas fa-user" aria-hidden="true"></i> Datos Básicos
    </legend>
    
    <div class="profile-form__row profile-form__row--two-cols">
      <div class="form-group">
        <label for="first_name" class="form-label">
          <i class="fas fa-user-circle" aria-hidden="true"></i> Nombre <span class="required">*</span>
        </label>
        <input 
          id="first_name"
          type="text" 
          class="form-input"
          [class.form-input--error]="hasFieldError('first_name')"
          formControlName="first_name"
          placeholder="Ej: Juan"
          required>
        <div class="form-error" *ngIf="getFieldError('first_name')">
          <i class="fas fa-exclamation-circle" aria-hidden="true"></i> {{ getFieldError('first_name') }}
        </div>
      </div>
      
      <div class="form-group">
        <label for="last_name" class="form-label">
          <i class="fas fa-user-circle" aria-hidden="true"></i> Apellido <span class="required">*</span>
        </label>
        <input 
          id="last_name"
          type="text" 
          class="form-input"
          [class.form-input--error]="hasFieldError('last_name')"
          formControlName="last_name"
          placeholder="Ej: Pérez"
          required>
        <div class="form-error" *ngIf="getFieldError('last_name')">
          <i class="fas fa-exclamation-circle" aria-hidden="true"></i> {{ getFieldError('last_name') }}
        </div>
      </div>
    </div>
    
    <div class="profile-form__row profile-form__row--two-cols">
      <div class="form-group">
        <label for="email" class="form-label">
          <i class="fas fa-envelope" aria-hidden="true"></i> Email <span class="required">*</span>
        </label>
        <input 
          id="email"
          type="email" 
          class="form-input"
          [class.form-input--error]="hasFieldError('email')"
          formControlName="email"
          placeholder="Ej: juan.perez@example.com"
          required>
        <div class="form-error" *ngIf="getFieldError('email')">
          <i class="fas fa-exclamation-circle" aria-hidden="true"></i> {{ getFieldError('email') }}
        </div>
      </div>
      
      <div class="form-group">
        <label for="telephone" class="form-label">
          <i class="fas fa-phone" aria-hidden="true"></i> Teléfono <span class="required">*</span>
        </label>
        <input 
          id="telephone"
          type="tel" 
          class="form-input"
          [class.form-input--error]="hasFieldError('telephone')"
          formControlName="telephone"
          placeholder="Ej: +1234567890"
          required>
        <div class="form-error" *ngIf="getFieldError('telephone')">
          <i class="fas fa-exclamation-circle" aria-hidden="true"></i> {{ getFieldError('telephone') }}
        </div>
      </div>
    </div>
    
    <div class="profile-form__row profile-form__row--two-cols">
      <div class="form-group">
        <label for="born_date" class="form-label">
          <i class="fas fa-calendar-alt" aria-hidden="true"></i> Fecha de Nacimiento
        </label>
        <input 
          id="born_date"
          type="date" 
          class="form-input"
          formControlName="born_date">
      </div>
      
      <div class="form-group">
        <label for="state" class="form-label">
          <i class="fas fa-map-marker-alt" aria-hidden="true"></i> Estado
        </label>
        <input 
          id="state"
          type="text" 
          class="form-input"
          formControlName="state"
          placeholder="Ej: Activo">
      </div>
    </div>
  </fieldset>
  
  <!-- Form Actions -->
  <div class="profile-form__actions">
    <button 
      type="button" 
      class="btn btn--outline"
      [disabled]="!isFormDirty || isLoading"
      (click)="onCancel()">
      Cancelar
    </button>
    <button 
      type="submit" 
      class="btn btn--primary"
      [disabled]="profileForm.invalid || !isFormDirty || isLoading">
      <span *ngIf="isLoading">
        <i class="fas fa-spinner fa-spin" aria-hidden="true"></i> Guardando...
      </span>
      <span *ngIf="!isLoading">Guardar Cambios</span>
    </button>
  </div>
</form>