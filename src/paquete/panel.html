<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backoffice - Jefe de Ventas</title>
    <link rel="stylesheet" href="css/panel.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="header-title">Backoffice Ventas</h1>
            </div>
            <div class="header-right">
                <div class="search-container">
                    <input type="text" class="search-input" placeholder="Buscar..." id="globalSearch">
                    <i class="fas fa-search search-icon"></i>
                </div>
                <div class="user-menu">
                    <img src="/placeholder.svg?height=32&width=32" alt="Usuario" class="user-avatar">
                    <span class="user-name">Jefe de Ventas</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <nav class="sidebar-nav">
            <ul class="nav-list">
                <li class="nav-item active">
                    <a href="#dashboard" class="nav-link" data-section="dashboard">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#productos" class="nav-link" data-section="productos">
                        <i class="fas fa-box"></i>
                        <span>Productos</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#paquetes" class="nav-link" data-section="paquetes">
                        <i class="fas fa-layer-group"></i>
                        <span>Paquetes</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#pedidos" class="nav-link" data-section="pedidos">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Pedidos</span>
                        <span class="badge">12</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#clientes" class="nav-link" data-section="clientes">
                        <i class="fas fa-users"></i>
                        <span>Clientes</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#reportes" class="nav-link" data-section="reportes">
                        <i class="fas fa-chart-bar"></i>
                        <span>Reportes</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="content-section active">
            <div class="section-header">
                <h2>Dashboard</h2>
                <div class="section-actions">
                    <button class="btn btn-secondary">
                        <i class="fas fa-download"></i>
                        Exportar
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-sync"></i>
                        Actualizar
                    </button>
                </div>
            </div>

            <!-- KPIs -->
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="kpi-content">
                        <h3>Ventas del Mes</h3>
                        <p class="kpi-value">$125,430</p>
                        <span class="kpi-change positive">+12.5%</span>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="kpi-content">
                        <h3>Pedidos Pendientes</h3>
                        <p class="kpi-value">23</p>
                        <span class="kpi-change negative">-5.2%</span>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">
                        <i class="fas fa-box"></i>
                    </div>
                    <div class="kpi-content">
                        <h3>Productos Activos</h3>
                        <p class="kpi-value">1,247</p>
                        <span class="kpi-change positive">+8.1%</span>
                    </div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="kpi-content">
                        <h3>Clientes Activos</h3>
                        <p class="kpi-value">892</p>
                        <span class="kpi-change positive">+15.3%</span>
                    </div>
                </div>
            </div>

            <!-- Charts and Recent Activity -->
            <div class="dashboard-grid">
                <div class="chart-container">
                    <h3>Ventas por Mes</h3>
                    <div class="chart-placeholder">
                        <i class="fas fa-chart-line"></i>
                        <p>Gráfico de ventas mensuales</p>
                    </div>
                </div>
                <div class="recent-activity">
                    <h3>Actividad Reciente</h3>
                    <div class="activity-list">
                        <div class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-plus"></i>
                            </div>
                            <div class="activity-content">
                                <p>Nuevo producto agregado</p>
                                <span class="activity-time">Hace 2 horas</span>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="activity-content">
                                <p>Pedido #1234 entregado</p>
                                <span class="activity-time">Hace 4 horas</span>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="activity-content">
                                <p>Nuevo cliente registrado</p>
                                <span class="activity-time">Hace 6 horas</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Productos Section -->
        <section id="productos" class="content-section">
            <div class="section-header">
                <h2>Productos</h2>
                <div class="section-actions">
                    <button class="btn btn-secondary">
                        <i class="fas fa-upload"></i>
                        Importar
                    </button>
                    <button class="btn btn-primary" id="createProductBtn">
                        <i class="fas fa-plus"></i>
                        Crear Producto
                    </button>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters-container">
                <div class="filter-group">
                    <input type="text" class="filter-input" placeholder="Buscar productos..." id="productSearch">
                    <select class="filter-select">
                        <option value="">Todas las categorías</option>
                        <option value="electronics">Electrónicos</option>
                        <option value="clothing">Ropa</option>
                        <option value="home">Hogar</option>
                    </select>
                    <select class="filter-select">
                        <option value="">Todos los estados</option>
                        <option value="active">Activo</option>
                        <option value="inactive">Inactivo</option>
                        <option value="draft">Borrador</option>
                    </select>
                </div>
            </div>

            <!-- Products Table -->
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Producto</th>
                            <th>Categoría</th>
                            <th>Precio</th>
                            <th>Stock</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <tr>
                            <td>#001</td>
                            <td>
                                <div class="product-info">
                                    <img src="/placeholder.svg?height=40&width=40" alt="Producto" class="product-image">
                                    <div>
                                        <p class="product-name">Smartphone XYZ</p>
                                        <p class="product-sku">SKU: ABC123</p>
                                    </div>
                                </div>
                            </td>
                            <td>Electrónicos</td>
                            <td>$599.99</td>
                            <td>25</td>
                            <td><span class="status-badge active">Activo</span></td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-icon" title="Ver">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-icon" title="Eliminar">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <!-- Skeleton loaders -->
                        <tr class="skeleton-row">
                            <td><div class="skeleton skeleton-text"></div></td>
                            <td><div class="skeleton skeleton-product"></div></td>
                            <td><div class="skeleton skeleton-text"></div></td>
                            <td><div class="skeleton skeleton-text"></div></td>
                            <td><div class="skeleton skeleton-text"></div></td>
                            <td><div class="skeleton skeleton-badge"></div></td>
                            <td><div class="skeleton skeleton-actions"></div></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination-container">
                <div class="pagination-info">
                    Mostrando 1-10 de 247 productos
                </div>
                <div class="pagination">
                    <button class="pagination-btn" disabled>
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="pagination-btn active">1</button>
                    <button class="pagination-btn">2</button>
                    <button class="pagination-btn">3</button>
                    <span class="pagination-dots">...</span>
                    <button class="pagination-btn">25</button>
                    <button class="pagination-btn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- Pedidos Section -->
        <section id="pedidos" class="content-section">
            <div class="section-header">
                <h2>Pedidos</h2>
                <div class="section-actions">
                    <button class="btn btn-secondary">
                        <i class="fas fa-filter"></i>
                        Filtros
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i>
                        Exportar
                    </button>
                </div>
            </div>

            <!-- Order Status Tabs -->
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab active" data-status="all">Todos (45)</button>
                    <button class="tab" data-status="pending">Pendientes (12)</button>
                    <button class="tab" data-status="processing">En Proceso (8)</button>
                    <button class="tab" data-status="delivered">Entregados (25)</button>
                </div>
            </div>

            <!-- Orders Table -->
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Pedido</th>
                            <th>Cliente</th>
                            <th>Fecha</th>
                            <th>Total</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="clickable-row" data-order-id="1234">
                            <td>
                                <div class="order-info">
                                    <p class="order-number">#1234</p>
                                    <p class="order-items">3 productos</p>
                                </div>
                            </td>
                            <td>
                                <div class="customer-info">
                                    <p class="customer-name">Juan Pérez</p>
                                    <p class="customer-email">juan@email.com</p>
                                </div>
                            </td>
                            <td>15/01/2024</td>
                            <td>$1,299.97</td>
                            <td><span class="status-badge pending">Pendiente</span></td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn-icon" title="Ver detalle">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon" title="Procesar">
                                        <i class="fas fa-play"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Other sections would follow similar pattern -->
        <section id="paquetes" class="content-section">
            <div class="section-header">
                <h2>Paquetes Prearmados</h2>
                <div class="section-actions">
                    <button class="btn btn-primary" id="createPackageBtn">
                        <i class="fas fa-plus"></i>
                        Crear Paquete
                    </button>
                </div>
            </div>
            <div class="empty-state">
                <i class="fas fa-layer-group"></i>
                <h3>Gestión de Paquetes</h3>
                <p>Crea y administra paquetes prearmados para tus clientes</p>
            </div>
        </section>

        <section id="clientes" class="content-section">
            <div class="section-header">
                <h2>Clientes</h2>
            </div>
            <div class="empty-state">
                <i class="fas fa-users"></i>
                <h3>Gestión de Clientes</h3>
                <p>Administra el estado de cuenta de tus clientes</p>
            </div>
        </section>

        <section id="reportes" class="content-section">
            <div class="section-header">
                <h2>Reportes</h2>
            </div>
            <div class="empty-state">
                <i class="fas fa-chart-bar"></i>
                <h3>Reportes y Análisis</h3>
                <p>Genera reportes detallados de ventas y rendimiento</p>
            </div>
        </section>
    </main>

    <!-- Order Detail Drawer -->
    <div class="drawer-overlay" id="drawerOverlay">
        <div class="drawer" id="orderDrawer">
            <div class="drawer-header">
                <h3>Detalle del Pedido #1234</h3>
                <button class="drawer-close" id="closeDrawer">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="drawer-content">
                <div class="order-summary">
                    <div class="summary-item">
                        <span>Cliente:</span>
                        <span>Juan Pérez</span>
                    </div>
                    <div class="summary-item">
                        <span>Fecha:</span>
                        <span>15/01/2024</span>
                    </div>
                    <div class="summary-item">
                        <span>Estado:</span>
                        <span class="status-badge pending">Pendiente</span>
                    </div>
                    <div class="summary-item">
                        <span>Total:</span>
                        <span class="total-amount">$1,299.97</span>
                    </div>
                </div>
                
                <div class="order-items">
                    <h4>Productos</h4>
                    <div class="item-list">
                        <div class="order-item">
                            <img src="/placeholder.svg?height=50&width=50" alt="Producto" class="item-image">
                            <div class="item-details">
                                <p class="item-name">Smartphone XYZ</p>
                                <p class="item-price">$599.99 x 1</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="drawer-actions">
                    <button class="btn btn-secondary">Cancelar Pedido</button>
                    <button class="btn btn-primary">Marcar como Entregado</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Package Creation Wizard Modal -->
    <div class="modal-overlay" id="packageWizardModal">
        <div class="modal wizard-modal">
            <div class="modal-header">
                <h3>Crear Paquete - Paso 1 de 3</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="wizard-progress">
                <div class="progress-step active">1</div>
                <div class="progress-line"></div>
                <div class="progress-step">2</div>
                <div class="progress-line"></div>
                <div class="progress-step">3</div>
            </div>
            <div class="modal-content">
                <div class="wizard-step active" id="step1">
                    <h4>Información Básica</h4>
                    <div class="form-group">
                        <label>Nombre del Paquete</label>
                        <input type="text" class="form-input" placeholder="Ej: Paquete Familiar">
                    </div>
                    <div class="form-group">
                        <label>Descripción</label>
                        <textarea class="form-textarea" placeholder="Describe el paquete..."></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary">Cancelar</button>
                <button class="btn btn-primary">Siguiente</button>
            </div>
        </div>
    </div>

    <script>
        // Global state management
const AppState = {
  currentSection: "dashboard",
  sidebarCollapsed: false,
  searchTerm: "",
  filters: {},
  selectedItems: [],
}

// DOM Elements
const elements = {
  menuToggle: document.getElementById("menuToggle"),
  sidebar: document.getElementById("sidebar"),
  mainContent: document.querySelector(".main-content"),
  navLinks: document.querySelectorAll(".nav-link"),
  contentSections: document.querySelectorAll(".content-section"),
  globalSearch: document.getElementById("globalSearch"),
  drawerOverlay: document.getElementById("drawerOverlay"),
  orderDrawer: document.getElementById("orderDrawer"),
  closeDrawer: document.getElementById("closeDrawer"),
  packageWizardModal: document.getElementById("packageWizardModal"),
  createPackageBtn: document.getElementById("createPackageBtn"),
  createProductBtn: document.getElementById("createProductBtn"),
  productSearch: document.getElementById("productSearch"),
  productsTableBody: document.getElementById("productsTableBody"),
}

// Initialize the application
document.addEventListener("DOMContentLoaded", () => {
  initializeEventListeners()
  initializeSearch()
  initializeTables()
  loadDashboardData()

  // Show skeleton loaders initially
  showSkeletonLoaders()

  // Simulate data loading
  setTimeout(() => {
    hideSkeletonLoaders()
    loadProductsData()
  }, 2000)
})

// Event Listeners
function initializeEventListeners() {
  // Menu toggle
  if (elements.menuToggle) {
    elements.menuToggle.addEventListener("click", toggleSidebar)
  }

  // Navigation
  elements.navLinks.forEach((link) => {
    link.addEventListener("click", handleNavigation)
  })

  // Drawer controls
  if (elements.closeDrawer) {
    elements.closeDrawer.addEventListener("click", closeDrawer)
  }

  if (elements.drawerOverlay) {
    elements.drawerOverlay.addEventListener("click", (e) => {
      if (e.target === elements.drawerOverlay) {
        closeDrawer()
      }
    })
  }

  // Modal controls
  if (elements.createPackageBtn) {
    elements.createPackageBtn.addEventListener("click", openPackageWizard)
  }

  if (elements.createProductBtn) {
    elements.createProductBtn.addEventListener("click", openProductModal)
  }

  // Close modals when clicking outside
  document.addEventListener("click", (e) => {
    if (e.target.classList.contains("modal-overlay")) {
      closeAllModals()
    }
  })

  // Close modals with Escape key
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
      closeAllModals()
      closeDrawer()
    }
  })

  // Table row clicks
  document.addEventListener("click", (e) => {
    const clickableRow = e.target.closest(".clickable-row")
    if (clickableRow) {
      const orderId = clickableRow.dataset.orderId
      if (orderId) {
        openOrderDrawer(orderId)
      }
    }
  })

  // Tab switching
  document.addEventListener("click", (e) => {
    if (e.target.classList.contains("tab")) {
      switchTab(e.target)
    }
  })

  // Pagination
  document.addEventListener("click", (e) => {
    if (e.target.classList.contains("pagination-btn") && !e.target.disabled) {
      handlePagination(e.target)
    }
  })

  // Window resize
  window.addEventListener("resize", handleResize)
}

// Navigation
function handleNavigation(e) {
  e.preventDefault()
  const targetSection = e.currentTarget.dataset.section

  if (targetSection && targetSection !== AppState.currentSection) {
    switchSection(targetSection)

    // Update active nav item
    elements.navLinks.forEach((link) => {
      link.parentElement.classList.remove("active")
    })
    e.currentTarget.parentElement.classList.add("active")

    AppState.currentSection = targetSection
  }
}

function switchSection(sectionId) {
  // Hide all sections
  elements.contentSections.forEach((section) => {
    section.classList.remove("active")
  })

  // Show target section
  const targetSection = document.getElementById(sectionId)
  if (targetSection) {
    targetSection.classList.add("active")

    // Load section-specific data
    loadSectionData(sectionId)
  }
}

function loadSectionData(sectionId) {
  switch (sectionId) {
    case "dashboard":
      loadDashboardData()
      break
    case "productos":
      loadProductsData()
      break
    case "pedidos":
      loadOrdersData()
      break
    case "clientes":
      loadClientsData()
      break
    case "reportes":
      loadReportsData()
      break
    case "paquetes":
      loadPackagesData()
      break
  }
}

// Sidebar
function toggleSidebar() {
  AppState.sidebarCollapsed = !AppState.sidebarCollapsed

  if (window.innerWidth <= 1024) {
    // Mobile behavior
    elements.sidebar.classList.toggle("active")
  } else {
    // Desktop behavior
    elements.sidebar.classList.toggle("collapsed")
    elements.mainContent.classList.toggle("expanded")
  }
}

// Search functionality
function initializeSearch() {
  if (elements.globalSearch) {
    elements.globalSearch.addEventListener("input", debounce(handleGlobalSearch, 300))
  }

  if (elements.productSearch) {
    elements.productSearch.addEventListener("input", debounce(handleProductSearch, 300))
  }
}

function handleGlobalSearch(e) {
  const searchTerm = e.target.value.toLowerCase()
  AppState.searchTerm = searchTerm

  // Implement global search logic
  console.log("Global search:", searchTerm)

  // Show search results or filter current view
  if (searchTerm.length > 2) {
    performGlobalSearch(searchTerm)
  }
}

function handleProductSearch(e) {
  const searchTerm = e.target.value.toLowerCase()
  filterProducts(searchTerm)
}

function performGlobalSearch(term) {
  // Simulate search API call
  showSearchResults(term)
}

function showSearchResults(term) {
  // Implementation for showing search results
  console.log("Showing search results for:", term)
}

// Table management
function initializeTables() {
  // Initialize sortable headers
  document.querySelectorAll(".data-table th").forEach((header) => {
    if (header.dataset.sortable !== "false") {
      header.style.cursor = "pointer"
      header.addEventListener("click", () => sortTable(header))
    }
  })
}

function sortTable(header) {
  const table = header.closest("table")
  const tbody = table.querySelector("tbody")
  const rows = Array.from(tbody.querySelectorAll("tr:not(.skeleton-row)"))
  const columnIndex = Array.from(header.parentNode.children).indexOf(header)
  const isAscending = header.classList.contains("sort-asc")

  // Remove existing sort classes
  header.parentNode.querySelectorAll("th").forEach((th) => {
    th.classList.remove("sort-asc", "sort-desc")
  })

  // Add new sort class
  header.classList.add(isAscending ? "sort-desc" : "sort-asc")

  // Sort rows
  rows.sort((a, b) => {
    const aValue = a.children[columnIndex].textContent.trim()
    const bValue = b.children[columnIndex].textContent.trim()

    // Try to parse as numbers
    const aNum = Number.parseFloat(aValue.replace(/[^0-9.-]/g, ""))
    const bNum = Number.parseFloat(bValue.replace(/[^0-9.-]/g, ""))

    if (!isNaN(aNum) && !isNaN(bNum)) {
      return isAscending ? bNum - aNum : aNum - bNum
    } else {
      return isAscending ? bValue.localeCompare(aValue) : aValue.localeCompare(bValue)
    }
  })

  // Reorder rows in DOM
  rows.forEach((row) => tbody.appendChild(row))
}

// Data loading functions
function loadDashboardData() {
  // Simulate API call
  setTimeout(() => {
    updateKPIs({
      sales: { value: "$125,430", change: "+12.5%", positive: true },
      orders: { value: "23", change: "-5.2%", positive: false },
      products: { value: "1,247", change: "+8.1%", positive: true },
      clients: { value: "892", change: "+15.3%", positive: true },
    })

    updateRecentActivity([
      { icon: "plus", text: "Nuevo producto agregado", time: "Hace 2 horas" },
      { icon: "check", text: "Pedido #1234 entregado", time: "Hace 4 horas" },
      { icon: "user", text: "Nuevo cliente registrado", time: "Hace 6 horas" },
    ])
  }, 500)
}

function loadProductsData() {
  // Simulate API call
  const products = [
    {
      id: "#001",
      name: "Smartphone XYZ",
      sku: "ABC123",
      category: "Electrónicos",
      price: "$599.99",
      stock: 25,
      status: "active",
      image: "/placeholder.svg?height=40&width=40",
    },
    {
      id: "#002",
      name: "Laptop Gaming",
      sku: "DEF456",
      category: "Electrónicos",
      price: "$1,299.99",
      stock: 12,
      status: "active",
      image: "/placeholder.svg?height=40&width=40",
    },
    {
      id: "#003",
      name: "Auriculares Bluetooth",
      sku: "GHI789",
      category: "Electrónicos",
      price: "$199.99",
      stock: 0,
      status: "inactive",
      image: "/placeholder.svg?height=40&width=40",
    },
  ]

  renderProductsTable(products)
}

function loadOrdersData() {
  console.log("Loading orders data...")
}

function loadClientsData() {
  console.log("Loading clients data...")
}

function loadReportsData() {
  console.log("Loading reports data...")
}

function loadPackagesData() {
  console.log("Loading packages data...")
}

// UI Update functions
function updateKPIs(data) {
  const kpiCards = document.querySelectorAll(".kpi-card")
  const keys = ["sales", "orders", "products", "clients"]

  kpiCards.forEach((card, index) => {
    const key = keys[index]
    if (data[key]) {
      const valueElement = card.querySelector(".kpi-value")
      const changeElement = card.querySelector(".kpi-change")

      if (valueElement) valueElement.textContent = data[key].value
      if (changeElement) {
        changeElement.textContent = data[key].change
        changeElement.className = `kpi-change ${data[key].positive ? "positive" : "negative"}`
      }
    }
  })
}

function updateRecentActivity(activities) {
  const activityList = document.querySelector(".activity-list")
  if (!activityList) return

  activityList.innerHTML = activities
    .map(
      (activity) => `
        <div class="activity-item">
            <div class="activity-icon">
                <i class="fas fa-${activity.icon}"></i>
            </div>
            <div class="activity-content">
                <p>${activity.text}</p>
                <span class="activity-time">${activity.time}</span>
            </div>
        </div>
    `,
    )
    .join("")
}

function renderProductsTable(products) {
  if (!elements.productsTableBody) return

  elements.productsTableBody.innerHTML = products
    .map(
      (product) => `
        <tr>
            <td>${product.id}</td>
            <td>
                <div class="product-info">
                    <img src="${product.image}" alt="Producto" class="product-image">
                    <div>
                        <p class="product-name">${product.name}</p>
                        <p class="product-sku">SKU: ${product.sku}</p>
                    </div>
                </div>
            </td>
            <td>${product.category}</td>
            <td>${product.price}</td>
            <td>${product.stock}</td>
            <td><span class="status-badge ${product.status}">${product.status === "active" ? "Activo" : "Inactivo"}</span></td>
            <td>
                <div class="action-buttons">
                    <button class="btn-icon" title="Ver" onclick="viewProduct('${product.id}')">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn-icon" title="Editar" onclick="editProduct('${product.id}')">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn-icon" title="Eliminar" onclick="deleteProduct('${product.id}')">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </td>
        </tr>
    `,
    )
    .join("")
}

// Skeleton loaders
function showSkeletonLoaders() {
  const skeletonRows = document.querySelectorAll(".skeleton-row")
  skeletonRows.forEach((row) => {
    row.style.display = "table-row"
  })
}

function hideSkeletonLoaders() {
  const skeletonRows = document.querySelectorAll(".skeleton-row")
  skeletonRows.forEach((row) => {
    row.style.display = "none"
  })
}

// Modal and Drawer functions
function openOrderDrawer(orderId) {
  if (elements.drawerOverlay) {
    elements.drawerOverlay.classList.add("active")
    document.body.style.overflow = "hidden"

    // Load order details
    loadOrderDetails(orderId)
  }
}

function closeDrawer() {
  if (elements.drawerOverlay) {
    elements.drawerOverlay.classList.remove("active")
    document.body.style.overflow = ""
  }
}

function openPackageWizard() {
  if (elements.packageWizardModal) {
    elements.packageWizardModal.classList.add("active")
    document.body.style.overflow = "hidden"
  }
}

function openProductModal() {
  // Create and show product creation modal
  showNotification("Función de crear producto en desarrollo", "info")
}

function closeAllModals() {
  const modals = document.querySelectorAll(".modal-overlay")
  modals.forEach((modal) => {
    modal.classList.remove("active")
  })
  document.body.style.overflow = ""
}

function loadOrderDetails(orderId) {
  // Simulate API call to load order details
  console.log("Loading order details for:", orderId)
}

// Tab switching
function switchTab(tabElement) {
  const tabsContainer = tabElement.closest(".tabs")
  const tabs = tabsContainer.querySelectorAll(".tab")

  tabs.forEach((tab) => tab.classList.remove("active"))
  tabElement.classList.add("active")

  const status = tabElement.dataset.status
  filterOrdersByStatus(status)
}

function filterOrdersByStatus(status) {
  console.log("Filtering orders by status:", status)
  // Implement order filtering logic
}

// Pagination
function handlePagination(button) {
  const currentPage = document.querySelector(".pagination-btn.active")
  const pageNumber = button.textContent

  if (button.querySelector("i")) {
    // Arrow button clicked
    const isNext = button.querySelector(".fa-chevron-right")
    const isPrev = button.querySelector(".fa-chevron-left")

    if (isNext) {
      // Go to next page
      console.log("Next page")
    } else if (isPrev) {
      // Go to previous page
      console.log("Previous page")
    }
  } else {
    // Number button clicked
    if (currentPage) currentPage.classList.remove("active")
    button.classList.add("active")

    loadPageData(Number.parseInt(pageNumber))
  }
}

function loadPageData(pageNumber) {
  console.log("Loading page:", pageNumber)
  showSkeletonLoaders()

  // Simulate API call
  setTimeout(() => {
    hideSkeletonLoaders()
    // Load new data based on page
  }, 1000)
}

// Product actions
function viewProduct(productId) {
  console.log("Viewing product:", productId)
  showNotification("Abriendo vista de producto...", "info")
}

function editProduct(productId) {
  console.log("Editing product:", productId)
  showNotification("Abriendo editor de producto...", "info")
}

function deleteProduct(productId) {
  if (confirm("¿Estás seguro de que quieres eliminar este producto?")) {
    console.log("Deleting product:", productId)
    showNotification("Producto eliminado correctamente", "success")
  }
}

// Filter functions
function filterProducts(searchTerm) {
  const rows = document.querySelectorAll("#productsTableBody tr:not(.skeleton-row)")

  rows.forEach((row) => {
    const productName = row.querySelector(".product-name")?.textContent.toLowerCase() || ""
    const productSku = row.querySelector(".product-sku")?.textContent.toLowerCase() || ""
    const category = row.cells[2]?.textContent.toLowerCase() || ""

    const matches = productName.includes(searchTerm) || productSku.includes(searchTerm) || category.includes(searchTerm)

    row.style.display = matches ? "" : "none"
  })
}

// Utility functions
function debounce(func, wait) {
  let timeout
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout)
      func(...args)
    }
    clearTimeout(timeout)
    timeout = setTimeout(later, wait)
  }
}

function showNotification(message, type = "info") {
  // Create notification element
  const notification = document.createElement("div")
  notification.className = `notification notification-${type}`
  notification.innerHTML = `
        <div class="notification-content">
            <i class="fas fa-${getNotificationIcon(type)}"></i>
            <span>${message}</span>
        </div>
        <button class="notification-close">
            <i class="fas fa-times"></i>
        </button>
    `

  // Add to DOM
  document.body.appendChild(notification)

  // Auto remove after 5 seconds
  setTimeout(() => {
    if (notification.parentNode) {
      notification.parentNode.removeChild(notification)
    }
  }, 5000)

  // Close button functionality
  notification.querySelector(".notification-close").addEventListener("click", () => {
    if (notification.parentNode) {
      notification.parentNode.removeChild(notification)
    }
  })
}

function getNotificationIcon(type) {
  const icons = {
    success: "check-circle",
    error: "exclamation-circle",
    warning: "exclamation-triangle",
    info: "info-circle",
  }
  return icons[type] || "info-circle"
}

function handleResize() {
  if (window.innerWidth <= 1024) {
    elements.sidebar.classList.remove("collapsed")
    elements.mainContent.classList.remove("expanded")

    if (AppState.sidebarCollapsed) {
      elements.sidebar.classList.remove("active")
    }
  }
}

// Auto-save functionality
function enableAutoSave(formElement) {
  const inputs = formElement.querySelectorAll("input, textarea, select")

  inputs.forEach((input) => {
    input.addEventListener(
      "input",
      debounce(() => {
        saveFormData(formElement)
      }, 1000),
    )
  })
}

function saveFormData(formElement) {
  const formData = new FormData(formElement)
  const data = Object.fromEntries(formData.entries())

  // Save to localStorage or send to server
  localStorage.setItem("formData", JSON.stringify(data))
  console.log("Form data auto-saved:", data)
}

// Export functions for global access
window.AppFunctions = {
  viewProduct,
  editProduct,
  deleteProduct,
  openOrderDrawer,
  closeDrawer,
  openPackageWizard,
  showNotification,
}

// Performance monitoring
function measurePerformance() {
  if ("performance" in window) {
    window.addEventListener("load", () => {
      setTimeout(() => {
        const perfData = performance.getEntriesByType("navigation")[0]
        console.log("Page load time:", perfData.loadEventEnd - perfData.loadEventStart, "ms")
      }, 0)
    })
  }
}

measurePerformance()

    </script>
</body>
</html>
